## 📜 Web前端跨平台（Windows/macOS）兼容性开发指南

### 1. 核心目标
确保我们开发的网页或应用在 **Windows** 和 **macOS**（包括Chrome, Firefox, Edge, Safari浏览器）上，具有**一致的视觉表现和功能体验**，避免布局“挤压”、“错位”或样式不一致。

### 2. 必须遵循的编码规范

#### 2.1 CSS 基础：使用 CSS Reset
在开始编写业务样式前，**必须**引入一个CSS重置（Reset）或标准化（Normalize）文件，以消除不同浏览器的默认样式差异。

*   **推荐选择**：**Normalize.css**
*   **使用方法**：在项目主CSS文件或入口文件中引入。
    *   **通过NPM/Yarn安装**：
        ```bash
        npm install normalize.css
        ```
        然后在你的主样式文件中导入：
        ```css
        @import '~normalize.css';
        ```
    *   **或直接通过CDN链接**（放在 `<head>` 里）：
        ```html
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css">
        ```

#### 2.2 字体：必须声明通用字体族
永远不要依赖操作系统默认字体。

*   **最佳实践**：在 `body` 或 `:root` 选择器中定义完整的、跨平台的字体栈。
*   **推荐字体栈**：
    ```css
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Helvetica, Arial, sans-serif;
    }
    ```
    *   `-apple-system` 调用 macOS 和 iOS 系统字体。
    *   `BlinkMacSystemFont` 调用 Windows 和 Linux 上 Chrome 等浏览器的系统字体。
    *   `"Segoe UI"` 是 Windows 的优雅字体。
    *   后面的 `Roboto`, `Helvetica`, `Arial` 是跨平台通用字体，确保最终降级。

#### 2.3 布局：慎用 Flexbox/Grid 的默认行为
使用 Flexbox 或 Grid 时，要明确指定子项的伸缩行为，而不是依赖默认值。

*   **关键检查点**：
    1.  **防止意外挤压**：如果某个子项**绝对不允许**被压缩，请为其设置 `flex-shrink: 0;`。
    2.  **明确基础尺寸**：为重要子项设置明确的 `flex-basis` 或 `width`，而不是完全依赖内容撑开。
    3.  **检查容器尺寸**：确认Flex/Grid容器的 `width` 或 `min-width` 是否合理，避免因父容器过小导致内部布局崩塌。

#### 2.4 单位与尺寸：相对单位优先
*   **推荐**：在布局和间距上，优先使用 **`rem`**、**`em`**、**`%`**、**`vw/vh`** 等相对单位，它们比固定 `px` 更具弹性和适应性。
*   **注意**：对于边框、阴影等需要极精细控制的样式，可以使用 `px`。

#### 2.5 图片与媒体：防止失真
*   **必须**：为所有 `<img>`、`<video>` 等替换元素设置 `max-width: 100%;` 和 `height: auto;`，以防止在高分辨率屏幕或不同容器中溢出或失真。
    ```css
    img, video {
      max-width: 100%;
      height: auto;
    }
    ```

### 3. 开发流程中的强制性检查步骤
在提交代码或发起合并请求（Pull Request）前，请完成以下检查：

1.  **本地基础检查**：
    *   在你的系统上，使用 **Chrome、Firefox** 浏览器分别测试页面。
    *   **必须**使用浏览器**开发者工具**，切换到手机、平板等不同视口模式进行检查。
2.  **跨平台模拟检查（必须做）**：
    *   在开发者工具的 **设备仿真模式** 下，选择不同的设备型号（特别是iPhone/iPad，它们使用Safari渲染引擎），查看布局和样式。
    *   在Windows上，可以尝试使用 **Edge** 浏览器，其与macOS **Safari** 浏览器使用同样的Webkit内核，部分表现有参考价值。
3.  **代码审查重点**：
    *   审查CSS时，请特别关注 **字体定义**、**Flex/Grid布局属性**和**图片样式**。

### 4. 推荐工具与资源
*   **跨平台测试**：
    *   **BrowserStack** / **Sauce Labs**：付费服务，可远程使用真实的Windows/macOS机器及各种浏览器进行测试。（公司可考虑提供）
    *   若条件有限，至少需要在 **一台实体Mac设备** 上进行最终测试。
*   **CSS辅助**：
    *   **Autoprefixer**：自动为CSS规则添加浏览器前缀，确保新特性兼容性。（通常集成在构建工具中，如Webpack、Vite）
    *   **Stylelint**：CSS代码检查工具，可配置规则来捕获潜在的兼容性问题。

### 5. 当发现问题时
1.  **精确定位**：在出问题的Mac电脑上，**立即使用浏览器开发者工具的“检查”功能**，查看问题元素的`Computed Style`（计算样式），并与正常情况对比。
2.  **沟通记录**：将问题截图、浏览器版本、操作系统版本以及定位到的具体CSS差异，清晰地记录在任务或Bug跟踪系统中。

---
**请所有协作者在开始开发前阅读此文档，并将其作为编码和审查的基本准则。**

---
